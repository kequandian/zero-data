SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for st_statistics_meta
-- ----------------------------
DROP TABLE IF EXISTS `st_statistics_meta`;
CREATE TABLE `st_statistics_meta` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `field` varchar(80) NOT NULL COMMENT '数据指标唯一标识符',
  `query_sql` text COMMENT '实时查询sql',
  `percent` smallint(6) DEFAULT '0' COMMENT '是否显示为百分比',
  `icon` varchar(255) DEFAULT NULL COMMENT '图标路径',
  `title` varchar(30) DEFAULT NULL COMMENT '图表标题',
  `field1` varchar(26) DEFAULT NULL COMMENT '保留字段1',
  `field2` varchar(26) DEFAULT NULL COMMENT '保留字段2',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=34 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of st_statistics_meta
-- ----------------------------
INSERT INTO `st_statistics_meta` VALUES ('1', 'total:today:rank@stat:sales:store', 'SELECT 0 AS seq, \'\' AS record_timeline, \'total:today:rank@stat:sales:store\' AS field, \'今日店铺排行\' AS record_name, CONCAT(\'第\', COALESCE(rownum, \'   \'), \'名\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM mall.t_store AS t_store LEFT JOIN( SELECT store_id, sum(total_price) AS month_sales, (@rownum := @rownum + 1) AS rownum FROM MallWebapp.t_order, (SELECT @rownum := 0) r WHERE store_id IS NOT NULL AND t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(t_order.created_date) = date(curdate()) GROUP BY store_id ORDER BY month_sales DESC ) AS t_order ON t_order.store_id = t_store.id', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('2', 'total:today:all@stat:product:all', 'SELECT 0 AS seq, \'\' AS record_timeline,\'total:today:all@stat:product:all\' AS field, \'今日销售量\' AS record_name, CONCAT(\'第\', COALESCE(count, \'   \'), \'名\')AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM mall.t_store AS t_store LEFT JOIN( SELECT count(*) AS count,store_id FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND created_date >= curdate() AND created_date < DATE_ADD(curdate(), INTERVAL 1 DAY) GROUP BY store_id ) AS t_order ON t_order.store_id = t_store.id ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('3', 'total:now:all@stat:product:all', 'SELECT 0 AS seq, \'\' AS record_timeline,\'total:now:all@stat:product:all\' AS field, \'剩余总库存\' AS record_name, T.valid_sku AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( T.`name`, \'$\', T.`code`) AS identifier FROM( SELECT t_store.`code`,t_store.`name`, wms_warehouse.id AS warehouse_id, sum(wms_inventory.valid_sku) AS valid_sku FROM mall.t_store AS t_store LEFT JOIN mall.wms_warehouse AS wms_warehouse ON wms_warehouse.id = t_store.warehouse_id LEFT JOIN mall.wms_inventory AS wms_inventory ON wms_warehouse.id = wms_inventory.warehouse_id GROUP BY t_store.id ) AS T', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('4', 'total:graph:count@stat:order:coun', 'SELECT @req := @req + 1 AS seq, \'今日\' AS record_timeline, \'total:graph:count@stat:order:count\' AS field, t_store.`hour` AS record_name, CASE WHEN count IS NOT NULL THEN COUNT ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM( SELECT * FROM ( SELECT hour_temp.*, t_store.id, t_store.`code`, t_store.`name` FROM ( SELECT @d :=@d + 1 `hour` FROM mysql.help_topic, (SELECT @d := - 1) temp WHERE @d < 23 ) AS hour_temp, mall.t_store AS t_store ORDER BY t_store.id, hour_temp.`hour` ) AS t_store LEFT JOIN ( SELECT count(*) AS count, HOUR (t_order.created_date) AS created_date, store_id FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND created_date >= curdate() AND created_date < DATE_ADD(curdate(), INTERVAL 1 DAY) GROUP BY store_id, HOUR (t_order.created_date) ORDER BY HOUR (t_order.created_date) ) AS t_order ON t_order.store_id = t_store.id AND t_order.created_date = t_store.`hour` ) AS t_store, (SELECT @req := 0) AS req_temp ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('5', 'total:graph:sum@stat:order:sum', 'SELECT @req := @req + 1 AS seq, \'今日\' AS record_timeline, \'total:graph:sum@stat:order:sum\' AS field, t_store.`hour` AS record_name, CASE WHEN count IS NOT NULL THEN count ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM( SELECT * FROM ( SELECT hour_temp.*, t_store.id, t_store.`code`, t_store.`name` FROM ( SELECT @d :=@d + 1 `hour` FROM mysql.help_topic, (SELECT @d := - 1) temp WHERE @d < 23 ) AS hour_temp, mall.t_store AS t_store ORDER BY t_store.id, hour_temp.`hour` ) AS t_store LEFT JOIN ( SELECT sum(t_order.total_price) AS count, HOUR (t_order.created_date) AS created_date, store_id FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) GROUP BY store_id, HOUR (t_order.created_date) ORDER BY HOUR (t_order.created_date) ) AS t_order ON t_order.store_id = t_store.id AND t_order.created_date = t_store.`hour` ) AS t_store, (SELECT @req := 0) AS req_temp ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('6', 'return:total:graph:sum@stat:order:return', 'SELECT @req := @req + 1 AS seq, \'今日\' AS record_timeline, \'return:total:graph:sum@stat:order:return\' AS field, t_store.`hour` AS record_name, CASE WHEN count IS NOT NULL THEN COUNT ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM( SELECT * FROM ( SELECT hour_temp.*, t_store.id, t_store.`code`, t_store.`name` FROM ( SELECT @d :=@d + 1 `hour` FROM mysql.help_topic, (SELECT @d := - 1) temp WHERE @d < 23 ) AS hour_temp, mall.t_store AS t_store ORDER BY t_store.id, hour_temp.`hour` ) AS t_store LEFT JOIN ( SELECT sum(service.refund_fee) AS count, HOUR (service.created_date) AS created_date, store_id FROM MallWebapp.t_order_customer_service AS service WHERE service.`status` = \'REFUNDED\' AND service.service_type IN (\'REFUND\', \'RETURN\') AND created_date >= curdate() AND created_date < DATE_ADD(curdate(), INTERVAL 1 DAY) GROUP BY store_id, HOUR (service.created_date) ) AS t_order ON t_order.store_id = t_store.id AND t_order.created_date = t_store.`hour` ) AS t_store, (SELECT @req := 0) AS req_temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('7', 'exchange:total:graph:sum@stat:order:exchange', 'SELECT @req := @req + 1 AS seq, \'今日\' AS record_timeline, \'exchange:total:graph:sum@stat:order:exchange\' AS field, t_store.`hour` AS record_name, CASE WHEN count IS NOT NULL THEN COUNT ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM( SELECT * FROM ( SELECT hour_temp.*, t_store.id, t_store.`code`, t_store.`name` FROM ( SELECT @d :=@d + 1 `hour` FROM mysql.help_topic, (SELECT @d := - 1) temp WHERE @d < 23 ) AS hour_temp, mall.t_store AS t_store ORDER BY t_store.id, hour_temp.`hour` ) AS t_store LEFT JOIN ( SELECT sum(service.refund_fee) AS count, HOUR (service.created_date) AS created_date, store_id FROM MallWebapp.t_order_customer_service AS service WHERE service.`status` = \'REFUNDED\' AND service.service_type = \'EXCHANGE\' AND created_date >= curdate() AND created_date < DATE_ADD(curdate(), INTERVAL 1 DAY) GROUP BY store_id, HOUR (service.created_date) ) AS t_order ON t_order.store_id = t_store.id AND t_order.created_date = t_store.`hour` ) AS t_store, (SELECT @req := 0) AS req_temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('8', 'total:today:assistant@stat:store:assistant', 'SELECT 0 AS seq, \'\' AS record_timeline,\'total:today:assistant@stat:store:assistant\' AS field, \'销售额\' AS record_name, CASE WHEN count IS NOT NULL THEN count ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM mall.t_store AS t_store LEFT JOIN( SELECT sum(t_order.total_price) AS count, t_order.store_id, t_order.store_user_id FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date (created_date) = date (curdate()) GROUP BY t_order.store_id, t_order.store_user_id ORDER BY sum(t_order.total_price) DESC LIMIT 1 ) AS t_order ON t_store.id = t_order.store_id', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('9', 'total:today:assistant@stat:store:assistant', 'SELECT 0 AS seq, \'\' AS record_timeline,\'total:today:assistant@stat:store:assistant\' AS field, \'成交单数\' AS record_name, CASE WHEN count IS NOT NULL THEN count ELSE 0 END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM mall.t_store AS t_store LEFT JOIN( SELECT count(*) AS count, t_order.store_id FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date (created_date) = date (curdate()) GROUP BY t_order.store_id, t_order.store_user_id ORDER BY sum(t_order.total_price) DESC LIMIT 1 ) AS t_order ON t_store.id = t_order.store_id', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('10', 'total:today:assistant@stat:store:assistant', 'SELECT 0 AS seq, \'\' AS record_timeline,\'total:today:assistant@stat:store:assistant\' AS field, \'今日销售冠军\' AS record_name, CASE WHEN store_user_name IS NOT NULL THEN store_user_name ELSE \'\' END AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, CONCAT( t_store.`name`, \'$\', t_store.`code`) AS identifier FROM mall.t_store AS t_store LEFT JOIN( SELECT count(*) AS count, t_order.store_id, t_order.store_user_name FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date (created_date) = date (curdate()) GROUP BY t_order.store_id, t_order.store_user_name ORDER BY sum(t_order.total_price) DESC LIMIT 1 ) AS t_order ON t_store.id = t_order.store_id', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('11', 'total:all:cost@stat:profit:child', 'SELECT 1 AS seq, \'\' AS record_timeline, \'total:all:cost@stat:profit:child\' AS field, \'商品成本价总额\' AS record_name, CONCAT( sum( item.cost_price * item.quantity)+0, \'元\' ) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order LEFT JOIN MallWebapp.t_order_item AS item ON item.order_id = t_order.id WHERE t_order.`status` IN( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' )', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('12', 'total:all:sell@stat:profit:child', 'SELECT 2 AS seq, \'\' AS record_timeline, \'total:all:sell@stat:profit:child\' AS field, \'商品销售价总额\' AS record_name, CONCAT( sum(item.final_price)+0, \'元\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order LEFT JOIN MallWebapp.t_order_item AS item ON item.order_id = t_order.id WHERE t_order.`status` IN( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' )', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('13', 'total:all:discounted@stat:profit:child', 'SELECT 3 AS seq, \'\' AS record_timeline, \'total:all:discounted@stat:profit:child\' AS field, \'实际折后金额\' AS record_name, CONCAT( sum( t_order.total_price - t_order.freight)+0, \'元\' ) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' )', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('14', 'total:all:profit@stat:profit:child', 'SELECT 4 AS seq, \'\' AS record_timeline, \'total:all:profit@stat:profit:child\' AS field, \'商品毛利\' AS record_name, CONCAT(sales.sales_price - cost.cost_price , \'元\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM( SELECT sum( item.cost_price * item.quantity) AS cost_price FROM MallWebapp.t_order LEFT JOIN MallWebapp.t_order_item AS item ON item.order_id = t_order.id WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) ) AS cost, ( SELECT sum( t_order.total_price - t_order.freight ) AS sales_price FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) ) AS sales', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('15', 'total:all:rate@stat:profit:child', 'SELECT 5 AS seq, \'\' AS record_timeline, \'total:all:rate@stat:profit:child\' AS field, \'毛利率\' AS record_name, CONCAT( ROUND(( sales.sales_price - cost.cost_price) / sales.sales_price * 100, 2), \'%\' ) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT sum( item.cost_price * item.quantity ) AS cost_price FROM MallWebapp.t_order LEFT JOIN MallWebapp.t_order_item AS item ON item.order_id = t_order.id WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) ) AS cost, ( SELECT sum( t_order.total_price - t_order.freight ) AS sales_price FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) ) AS sales', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('16', 'total:today:sales@stat:dashboard:revenue', 'SELECT 1 AS seq, \'\' AS record_timeline, \'total:today:sales@stat:dashboard:revenue\' AS field, \'销售金额\' AS record_name, CONCAT( \'￥ \', COALESCE(sum(t_order.origin_price), 0)) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) LIMIT 1', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('17', 'total:today:discount@stat:dashboard:revenue', 'SELECT 2 AS seq, \'\' AS record_timeline, \'total:today:discount@stat:dashboard:revenue\' AS field, \'优惠金额\' AS record_name, CONCAT( \'￥ \', COALESCE( SUM( t_order.origin_price - t_order.total_price - freight), 0 ) ) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(t_order.created_date) = date(CURRENT_DATE)', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('18', 'total:today:revenue@stat:dashboard:revenue', 'SELECT 3 AS seq, \'\' AS record_timeline, \'total:today:revenue@stat:dashboard:revenue\' AS field, \'实际营收金额\' AS record_name, CONCAT( \'￥ \', COALESCE(sum(t_order.total_price), 0)) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate())', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('19', 'total:today:count@stat:dashboard:revenue', 'SELECT 4 AS seq, \'\' AS record_timeline, \'total:today:count@stat:dashboard:revenue\' AS field, \'交易单数\' AS record_name, CONCAT( COALESCE(count(*), 0), \' 单\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('20', 'total:today:stat@stat:dashboard:sales', 'SELECT @req := @req + 2 AS seq, \'\' AS record_timeline, \'total:today:stat@stat:dashboard:sales\' AS field, t_store.`hour` AS record_name, FORMAT(COALESCE(count, 0), 2) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT * FROM ( SELECT @d :=@d + 1 `hour` FROM mysql.help_topic, (SELECT @d := - 1) temp WHERE @d < 23 ORDER BY `hour`) AS hour_temp LEFT JOIN ( SELECT SUM(t_order.total_price) AS count, HOUR (t_order.created_date) AS created_date FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) GROUP BY HOUR (t_order.created_date) ORDER BY HOUR (t_order.created_date) ) AS t_order ON t_order.created_date = hour_temp.`hour` ) AS t_store, (SELECT @req := - 1) AS req_temp UNION ALL SELECT @req2 := @req2 + 2 AS seq, \'\' AS record_timeline, \'total:today:stat@stat:dashboard:sales\' AS field, t_store.`hour` AS record_name, FORMAT(COALESCE (count, 0), 0) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'1\' AS timeline, \'\' AS identifier FROM ( SELECT * FROM ( SELECT @d2 :=@d2 + 1 `hour` FROM mysql.help_topic, (SELECT @d2 := - 1) temp WHERE @d2 < 23 ORDER BY `hour` ) AS hour_temp LEFT JOIN ( SELECT COUNT(*) AS count, HOUR (t_order.created_date) AS created_date FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) GROUP BY HOUR (t_order.created_date) ORDER BY HOUR (t_order.created_date) ) AS t_order ON t_order.created_date = hour_temp.`hour` ) AS t_store, (SELECT @req2 := 0) AS req_temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('21', 'total:sum:per@stat:dashboard:sales', 'SELECT 1 AS seq, \'\' AS record_timeline, \'total:sum:per@stat:dashboard:sales\' AS field, \'今日销售额\' AS record_name, CONCAT( \'￥\', COALESCE(count, 0)) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT COALESCE (sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) ) AS today', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('22', 'total:sum:per@stat:dashboard:sales', 'SELECT 2 AS seq, \'\' AS record_timeline, \'total:sum:per@stat:dashboard:sales\' AS field, \'昨日\' AS record_name, CONCAT( \'￥\', COALESCE(sum(count), 0)) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT COALESCE (sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) )   ) yesterday', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('23', 'total:sum:per@stat:dashboard:sales', 'SELECT 3 AS seq, \'\' AS record_timeline, \'total:sum:per@stat:dashboard:sales\' AS field, CASE WHEN COALESCE(per, 0) < 0 THEN \'下降\' ELSE \'上升\' END AS record_name, COALESCE (abs(per), 0) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'W\' AS timeline, \'\' AS identifier FROM ( SELECT format( ( today.count - yesterday.count) / yesterday.count * 100, 2 ) AS per FROM ( SELECT COALESCE (sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) ) AS today, ( SELECT COALESCE (sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) ) ) yesterday ) AS temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('24', 'total:sum:per@stat:dashboard:sales', 'SELECT 4 AS seq, \'\' AS record_timeline, \'total:sum:per@stat:dashboard:sales\' AS field, CASE WHEN COALESCE(per, 0) < 0 THEN \'down\' ELSE \'up\' END AS record_name, \'%\' AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'\' AS timeline, \'\' AS identifier FROM ( SELECT format((today.count - yesterday.count) /yesterday.count * 100, 2) AS per FROM ( SELECT COALESCE(sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\') AND date(created_date) = date(curdate())   ) as today, ( SELECT COALESCE(sum(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) )   ) yesterday ) AS temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('25', 'total:count:per@stat:dashboard:sales', 'SELECT 5 AS seq, \'\' AS record_timeline, \'total:count:per@stat:dashboard:sales\' AS field, \'今日销售订单\' AS record_name, CONCAT( COALESCE(count, 0), \'单\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT COALESCE ( count(t_order.total_price), 0 ) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate())   ) AS today', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('26', 'total:count:per@stat:dashboard:sales', 'SELECT 6 AS seq, \'\' AS record_timeline, \'total:count:per@stat:dashboard:sales\' AS field, \'昨日 \' AS record_name, CONCAT( COALESCE(count, 0), \' 单\') AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM ( SELECT COALESCE ( count(t_order.total_price), 0 ) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) )   ) yesterday', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('27', 'total:count:per@stat:dashboard:sales', 'SELECT 7 AS seq, \'\' AS record_timeline, \'total:count:per@stat:dashboard:sales\' AS field, CASE WHEN COALESCE(per, 0) < 0 THEN \'下降\' ELSE \'上升\' END AS record_name, COALESCE (abs(per), 0) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'W\' AS timeline, \'\' AS identifier FROM ( SELECT format( ( today.count - yesterday.count) / yesterday.count * 100, 2 ) AS per FROM ( SELECT COALESCE ( count(t_order.total_price), 0 ) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate()) ) AS today, ( SELECT COALESCE ( count(t_order.total_price), 0 ) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) ) ) yesterday ) AS temp', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('28', 'total:count:per@stat:dashboard:sales', 'SELECT 8 AS seq, \'\' AS record_timeline, \'total:count:per@stat:dashboard:sales\' AS field, CASE WHEN COALESCE(per, 0) < 0 THEN \'down\' ELSE \'up\' END AS record_name, \'%\' AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'\' AS timeline, \'\' AS identifier FROM ( SELECT format( ( today.count - yesterday.count) / yesterday.count * 100, 2 ) AS per FROM ( SELECT COALESCE (count(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date(curdate())   ) AS today, ( SELECT COALESCE (count(t_order.total_price), 0) AS count FROM MallWebapp.t_order WHERE t_order.`status` IN ( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\' ) AND date(created_date) = date( DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY) )   ) yesterday ) AS temp ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('29', 'total:all:count@stat:dashboard:order', 'SELECT 1 AS seq, \'\' AS record_timeline, \'total:all:count@stat:dashboard:order\' AS field, \'总订单数\' AS record_name, count(*) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` IN( \'PAID_CONFIRM_PENDING\', \'CONFIRMED_DELIVER_PENDING\', \'DELIVERING\', \'DELIVERED_CONFIRM_PENDING\', \'CANCELED_RETURN_PENDING\', \'CLOSED_CONFIRMED\', \'CANCELED_REFUND_PENDING\', \'CONFIRMED_PICK_PENDING\') ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('30', 'total:pending:deliver@stat:dashboard:order', 'SELECT 2 AS seq, \'\' AS record_timeline, \'total:pending:deliver@stat:dashboard:order\' AS field, \'待发货订单\' AS record_name, count(*) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` = \'CONFIRMED_DELIVER_PENDING\' ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('31', 'total:pending:pick@stat:dashboard:order', 'SELECT 3 AS seq, \'\' AS record_timeline, \'total:pending:pick@stat:dashboard:order\' AS field, \'待收货订单\' AS record_name, count(*) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` = \'CONFIRMED_PICK_PENDING\' ', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('32', 'total:pending:refund@stat:dashboard:order', 'SELECT 4 AS seq, \'\' AS record_timeline, \'total:pending:refund@stat:dashboard:order\' AS field, \'待退款订单\' AS record_name, count(*) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` = \'CANCELED_REFUND_PENDING\'', '0', null, null, null, null);
INSERT INTO `st_statistics_meta` VALUES ('33', 'total:pending:return@stat:dashboard:order', 'SELECT 5 AS seq, \'\' AS record_timeline, \'total:pending:return@stat:dashboard:order\' AS field, \'待退货订单\' AS record_name, count(*) AS record_value, \'\' AS record_tuple, \'\' AS record_cluster, \'0\' AS timeline, \'\' AS identifier FROM MallWebapp.t_order WHERE t_order.`status` = \'CANCELED_RETURN_PENDING\'', '0', null, null, null, null);
